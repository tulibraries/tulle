version: 2

jobs:
  build:
    docker:
      - image: circleci/ruby:2.6.5
        environment:
          APP_ENV: test
    steps:
      - checkout

      - run:
          name: Bundle install dependencies.
          command: bundle install --path vendor/bundle

      - run:
          name: Add missing log file.
          command: touch ~/project/app/log/test.log

      - type: shell
        name: Run linter.
        command: bundle exec rubocop

      - type: shell
        name: Run tests.
        command: bundle exec rspec

